@model SHIVAMFaceEcomm.Models.ProductDetail
@{
    ViewBag.Title = "ProductDetail";
    var allAttributes = Model.Attributes.Select(p => p.AttributeName).Distinct().ToList();
}






<section class="section white-backgorund">
    <div class="container">
        <div class="row">
            <!-- start sidebar -->
            <div class="col-sm-4">
                <div class='carousel slide product-slider' data-ride='carousel' data-interval="false">
                    <div class='carousel-inner'>
                        @for (int i = 0; i < Model.Attributes.Count(); i++)
                        {
                            if (i == 0)
                            {
                                <div class='item active'>
                                    <figure>

                                        @if(Model.Attributes[i].ImagePath != null || Model.Attributes[i].ImagePath != "")
                                        {
                                            
                                            <div class="magnify">

                                           <!-- This is the magnifying glass which will contain the original/large version -->
                                              <div class="large"></div>

                                             <!-- This is the small image -->
                                                <img class="small" src="http://localhost:7080/ProductImages/@Model.Attributes[i].ImagePath" width="200" />

                                                </div>
                                            
                                            
                                           
                                        }
                                        
                                        
                                           @if(Model.Attributes[i].ImagePath == null)
                                        {
                                            <img src="/Content/images/default-no-image.png" alt="">
                                        }

                                       
                                    </figure>
                                </div><!-- end item -->
                            }
                            else
                            {
                                <div class='item'>
                                    <figure>
                                        @if (Model.Attributes[i].ImagePath != null || Model.Attributes[i].ImagePath != "")
                                        {
                                         <div class="magnify">

                                           <!-- This is the magnifying glass which will contain the original/large version -->
                                              <div class="large"></div>

                                             <!-- This is the small image -->
                                                <img class="small" src="http://localhost:7080/ProductImages/@Model.Attributes[i].ImagePath" width="200" />

                                                </div>
                                        }


                                        @if (Model.Attributes[i].ImagePath == null)
                                        {
                                            <img src="/Content/images/default-no-image.png" alt="">
                                        }
                                    </figure>
                                </div><!-- end item -->
                            }



                        }

                        <!-- Arrows -->
                        <a class='left carousel-control' href='.product-slider' data-slide='prev'>
                            <span class='fa fa-angle-left'></span>
                        </a>
                        <a class='right carousel-control' href='.product-slider' data-slide='next'>
                            <span class='fa fa-angle-right'></span>
                        </a>
                    </div><!-- end carousel-inner -->
                    <!-- thumbs -->
                    <ol class='carousel-indicators mCustomScrollbar meartlab'>
                        @for (int i = 0; i < Model.Attributes.Count(); i++)
                        {
                            <li data-target='.product-slider' data-slide-to='@i'>
                                @if (Model.Attributes[i].ImagePath != null || Model.Attributes[i].ImagePath != "")
                                {
                                    <img src='http://localhost:7080/ProductImages/@Model.Attributes[i].ImagePath' alt='' />
                                }


                                @if (Model.Attributes[i].ImagePath == null)
                                {
                                    <img src="/Content/images/default-no-image.png" alt="">
                                }
                            </li>
                        }

                    </ol><!-- end carousel-indicators -->
                </div><!-- end carousel -->
            </div><!-- end col -->
            <!-- end sidebar -->
            <div class="col-sm-8">
                <div class="row">
                    <div class="col-sm-12">
                        <h2 class="title">@Model.Product.ProductName</h2>
                        <p class="text-gray alt-font">Product code: @Model.Product.ProductCode</p>

                        <ul class="list list-inline">

                            <li><h5 class="text-primary">$79.88</h5></li>
                            <li>
                                <i class="fa fa-star text-warning"></i>
                                <i class="fa fa-star text-warning"></i>
                                <i class="fa fa-star text-warning"></i>
                                <i class="fa fa-star text-warning"></i>
                                <i class="fa fa-star-half-o text-warning"></i>
                            </li>
                            <li><a href="javascript:void(0);">(4 reviews)</a></li>
                        </ul>
                    </div><!-- end col -->
                </div><!-- end row -->

                <hr class="spacer-5"><hr class="spacer-10 no-border">

                <div class="row">
                    <div class="col-sm-12">
                        <p>@Model.Product.Description</p>
                    
                        <hr class="spacer-15">
                        <div class="row">

                            @for (int i = 0; i < allAttributes.Count(); i++)
                            {
                                <div class="col-md-3 col-sm-6 col-xs-12">
                                    <dl class="param param-feature">
                                        <dt>@allAttributes[i]</dt>
                                        @{
                                var allattributeV = Model.Attributes.Where(p => p.AttributeName == allAttributes[i]).Select(p => p.AttributeValue).Distinct().ToList();
                                        }
                                        <dd>
                                            <select class="form-control" id="attribute@(i+1)" onchange="GetAttributeDate(@allAttributes[i])" attributename="@allAttributes[i]">
                                                @for (int k = 0; k < allattributeV.Count(); k++)
                                                {
                                                    <option value="@allattributeV[k]"> @allattributeV[k] </option>
                                                }


                                            </select>
                                        </dd>
                                    </dl>  <!-- item-property-hor .// -->
                                </div>
                            }


                            <!-- end col -->
                            <div class="col-md-3 col-sm-12">
                                <dl class="param param-feature">
                                    <dt>QTY</dt>

                                    <dd>
                                        <select class="form-control" name="select">
                                            <option value="">1</option>
                                            <option value="">2</option>
                                            <option value="">3</option>
                                            <option value="">4</option>
                                            <option value="">5</option>
                                            <option value="">6</option>
                                            <option value="">7</option>
                                        </select>
                                    </dd>
                                </dl>  <!-- item-property-hor .// -->

                            </div><!-- end col -->
                        </div><!-- end row -->
                        <hr class="spacer-15">

                        <ul class="list list-inline">
                            <li><button type="button" class="btn btn-default btn-md round"><i class="fa fa-shopping-basket mr-5"></i>Add to Cart</button></li>
                            <li><button type="button" id="rzp-button1" class="btn btn-gray btn-md round"><i class="fa fa-heart mr-5"></i>Buy Now</button></li>
                            <li>Share this product: </li>
                            <li>
                                <ul class="social-icons style1">
                                    <li class="facebook"><a href="javascript:void(0);"><i class="fa fa-facebook"></i></a></li>
                                    <li class="twitter"><a href="javascript:void(0);"><i class="fa fa-twitter"></i></a></li>
                                    <li class="pinterest"><a href="javascript:void(0);"><i class="fa fa-pinterest"></i></a></li>
                                </ul>
                            </li>
                        </ul>
                    </div><!-- end col -->
                </div><!-- end row -->
            </div><!-- end col -->
        </div><!-- end row -->

        <hr class="spacer-60">

        <div class="row" ng-app="MyApp" ng-controller="CustomerReviewController">
            <div class="col-xs-12 col-sm-3">
                <!-- Nav tabs -->
                <ul class="nav nav-tabs style2 tabs-left">
                    <li class="active"><a href="#description" data-toggle="tab">Additional Info</a></li>
                    <li><a href="#reviews" data-toggle="tab">Reviews ({{reviews.length}})</a></li>
                </ul>
            </div><!-- end col -->
            <div class="col-xs-12 col-sm-9">
                <!-- Tab panes -->
                <div class="tab-content style2">
                    <div class="tab-pane active" id="description">
                        <h5>Additional Info</h5>
                        <p>
                            @Model.Product.Description
                        </p>

                        <hr class="spacer-15">

                        <div class="row">
                            <div class="col-sm-12 col-md-6">
                                <dl class="dl-horizontal">


                                    @for (int i = 0; i < allAttributes.Count(); i++)
                                    {


                                        <dt>@allAttributes[i]</dt>
                                        {
                                            var allattributeV = Model.Attributes.Where(p => p.AttributeName == allAttributes[i]).Select(p => p.AttributeValue).Distinct().ToList();

                                            <dd>

                                                @for (int k = 0; k < allattributeV.Count(); k++)
                                                {
                                                    if ((allattributeV.Count()-1)==k)
                                                    {
                                                        @allattributeV[k] 
                                                    }
                                                    else
                                                    {
                                                        @(allattributeV[k] + ",")
                                                    }


                                                }



                                            </dd>
                                        }

                                    }






                                </dl>
                            </div><!-- end col -->
                            <div class="col-sm-12 col-md-6">
                                <dl class="dl-horizontal">
                                    <dt>Weight</dt>
                                    <dd>1.65 kg</dd>
                                    <dt>Manufacturer</dt>
                                    <dd>Istanbul</dd>
                                </dl>
                            </div><!-- end col -->
                        </div><!-- end row -->
                    </div><!-- end tab-pane -->
                    <div class="tab-pane" id="reviews">
                        <h5>{{reviews.length}} Review for "@Model.Product.ProductName"</h5>

                        <hr class="spacer-10 no-border">

                        <div class="comments" ng-repeat="rev in reviews">
                            <div class="comment-image">
                                <figure>
                                    <img src="img/team/team_01.jpg" alt="" />
                                </figure>
                            </div><!-- end comments-image -->
                            <div class="comment-content">
                                <div class="comment-content-head">
                                    <h6 class="comment-title">{{rev.Email}}</h6>
                                    <ul class="list list-inline comment-meta">
                                        <li>
                                            <i class="fa fa-star text-warning"></i>
                                            <i class="fa fa-star text-warning"></i>
                                            <i class="fa fa-star text-warning"></i>
                                            <i class="fa fa-star text-warning"></i>
                                            <i class="fa fa-star text-warning"></i>
                                        </li>
                                    </ul>
                                </div><!-- end comment-content-head -->
                                <p>{{rev.Review}}</p>
                                <cite>{{rev.Name}}</cite>
                            </div><!-- end comment-content -->
                        </div><!-- end comments -->



                        <hr class="spacer-30">

                        <h5>Add a review</h5>
                        <p>How do you rate this product?</p>

                        <hr class="spacer-5 no-border">

                        <form>
                            <input type="text" class="rating rating-loading" value="5" data-size="sm" title="">
                        </form>

                        <hr class="spacer-10 no-border">

                        <div class="form-group">
                            <label for="reviewName">Name</label>
                            <input type="text" id="reviewName" ng-model="review.Name" class="form-control input-md" placeholder="Your Name">
                        </div><!-- end form-group -->
                        <div class="form-group">
                            <label for="reviewEmail">E-mail</label>
                            <input type="text" id="reviewEmail" ng-model="review.Email" class="form-control input-md" placeholder="Your E-mail">
                        </div><!-- end form-group -->
                        <div class="form-group">
                            <label for="reviewMessage">Review</label>
                            <textarea id="reviewMessage" rows="5" ng-model="review.Review" class="form-control" placeholder="Your review"></textarea>
                        </div><!-- end form-group -->
                        <div class="form-group">
                            <input type="submit" class="btn btn-default round btn-md" ng-click="AddReview()" value="Submit Review">
                        </div><!-- end form-group -->
                    </div><!-- end tab-pane -->
                </div><!-- end tab-content -->
            </div><!-- end col -->
        </div><!-- end row -->

        <hr class="spacer-60">

        <div class="row">
            <div class="col-sm-12">
                <h4 class="mb-20">You May Also Like</h4>
            </div><!-- end col -->
        </div><!-- end row -->

        <div class="row">
            <div class="col-sm-12">
                <div id="owl-demo" class="owl-carousel column-4 owl-theme">
                    <div class="item">
                        <div class="thumbnail store style1">
                            <div class="header">
                                <figure>
                                    <a href="shop-single-product-v1.html">
                                        <img src="img/products/bags_03.jpg" alt="">
                                    </a>
                                </figure>
                            </div>
                            <div class="caption">
                                <h6 class="regular"><a href="shop-single-product-v1.html">Printed Summer Dress</a></h6>
                                <div class="price">
                                    <small class="amount off">$68.99</small>
                                    <span class="amount text-primary">$59.99</span>
                                </div>
                                <span class="product-badge bottom left text-warning">
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star-half-o"></i>
                                    <i class="fa fa-star-o"></i>
                                </span>
                            </div><!-- end caption -->
                        </div><!-- end thumbnail -->
                    </div><!-- end item -->

                    <div class="item">
                        <div class="thumbnail store style1">
                            <div class="header">
                                <figure>
                                    <a href="shop-single-product-v1.html">
                                        <img src="img/products/bags_06.jpg" alt="">
                                    </a>
                                </figure>
                            </div>
                            <div class="caption">
                                <h6 class="regular"><a href="shop-single-product-v1.html">Printed Summer Dress</a></h6>
                                <div class="price">
                                    <small class="amount off">$68.99</small>
                                    <span class="amount text-primary">$59.99</span>
                                </div>
                                <span class="product-badge bottom left text-warning">
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star-half-o"></i>
                                    <i class="fa fa-star-o"></i>
                                </span>
                            </div><!-- end caption -->
                        </div><!-- end thumbnail -->
                    </div><!-- end item -->

                    <div class="item">
                        <div class="thumbnail store style1">
                            <div class="header">
                                <figure>
                                    <a href="shop-single-product-v1.html">
                                        <img src="img/products/hoseholds_01.jpg" alt="">
                                    </a>
                                </figure>
                            </div>
                            <div class="caption">
                                <h6 class="regular"><a href="shop-single-product-v1.html">Printed Summer Dress</a></h6>
                                <div class="price">
                                    <small class="amount off">$68.99</small>
                                    <span class="amount text-primary">$59.99</span>
                                </div>
                                <span class="product-badge bottom left text-warning">
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star-half-o"></i>
                                    <i class="fa fa-star-o"></i>
                                </span>
                            </div><!-- end caption -->
                        </div><!-- end thumbnail -->
                    </div><!-- end item -->

                    <div class="item">
                        <div class="thumbnail store style1">
                            <div class="header">
                                <figure>
                                    <a href="shop-single-product-v1.html">
                                        <img src="img/products/fashion_02.jpg" alt="">
                                    </a>
                                </figure>
                            </div>
                            <div class="caption">
                                <h6 class="regular"><a href="shop-single-product-v1.html">Printed Summer Dress</a></h6>
                                <div class="price">
                                    <small class="amount off">$68.99</small>
                                    <span class="amount text-primary">$59.99</span>
                                </div>
                                <span class="product-badge bottom left text-warning">
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star-half-o"></i>
                                    <i class="fa fa-star-o"></i>
                                </span>
                            </div><!-- end caption -->
                        </div><!-- end thumbnail -->
                    </div><!-- end item -->
                    <div class="item">
                        <div class="thumbnail store style1">
                            <div class="header">
                                <figure>
                                    <a href="shop-single-product-v1.html">
                                        <img src="img/products/hoseholds_03.jpg" alt="">
                                    </a>
                                </figure>
                            </div>
                            <div class="caption">
                                <h6 class="regular"><a href="shop-single-product-v1.html">Printed Summer Dress</a></h6>
                                <div class="price">
                                    <small class="amount off">$68.99</small>
                                    <span class="amount text-primary">$59.99</span>
                                </div>
                                <span class="product-badge bottom left text-warning">
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star"></i>
                                    <i class="fa fa-star-half-o"></i>
                                    <i class="fa fa-star-o"></i>
                                </span>
                            </div><!-- end caption -->
                        </div><!-- end thumbnail -->
                    </div><!-- end item -->
                </div><!-- end owl carousel -->
            </div><!-- end col -->
        </div><!-- end row -->
    </div><!-- end container -->
</section>
@section scripts
{
    <style>
        .row > .column {
            padding: 0 8px;
        }

        .row:after {
            content: "";
            display: table;
            clear: both;
        }

        .column {
            float: left;
            width: 50px;
            height: 50px;
            margin: 10px;
        }

        /* The Modal (background) */
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            padding-top: 100px;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: black;
        }

        /* Modal Content */
        .modal-content {
            position: relative;
            background-color: #fefefe;
            margin: auto;
            padding: 0;
            width: 90%;
            max-width: 1200px;
        }

        /* The Close Button */
        .close {
            color: white;
            position: absolute;
            top: 10px;
            right: 25px;
            font-size: 35px;
            font-weight: bold;
        }

            .close:hover,
            .close:focus {
                color: #999;
                text-decoration: none;
                cursor: pointer;
            }

        .mySlides {
            display: none;
        }

        .cursor {
            cursor: pointer;
        }

        /* Next & previous buttons */
        .prev,
        .next {
            cursor: pointer;
            position: absolute;
            top: 50%;
            width: auto;
            padding: 16px;
            margin-top: -50px;
            color: white;
            font-weight: bold;
            font-size: 20px;
            transition: 0.6s ease;
            border-radius: 0 3px 3px 0;
            user-select: none;
            -webkit-user-select: none;
        }

        /* Position the "next button" to the right */
        .next {
            right: 0;
            border-radius: 3px 0 0 3px;
        }

            /* On hover, add a black background color with a little bit see-through */
            .prev:hover,
            .next:hover {
                background-color: rgba(0, 0, 0, 0.8);
            }

        /* Number text (1/3 etc) */
        .numbertext {
            color: #f2f2f2;
            font-size: 12px;
            padding: 8px 12px;
            position: absolute;
            top: 0;
        }

        img {
            margin-bottom: -4px;
        }

        .caption-container {
            text-align: center;
            background-color: black;
            padding: 2px 16px;
            color: white;
        }

        .demo {
            opacity: 0.6;
        }

            .active,
            .demo:hover {
                opacity: 1;
            }

        img.hover-shadow {
            transition: 0.3s;
        }

        .hover-shadow:hover {
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
        }
    </style>
    <script>
        function openModal() {
            document.getElementById('myModal').style.display = "block";
        }

        function closeModal() {
            document.getElementById('myModal').style.display = "none";
        }

        var slideIndex = 1;
        showSlides(slideIndex);

        function plusSlides(n) {
            showSlides(slideIndex += n);
        }

        function currentSlide(n) {
            showSlides(slideIndex = n);
        }

        function showSlides(n) {
            var i;
            var slides = document.getElementsByClassName("mySlides");
            var dots = document.getElementsByClassName("demo");
            var captionText = document.getElementById("caption");
            if (n > slides.length) { slideIndex = 1 }
            if (n < 1) { slideIndex = slides.length }
            for (i = 0; i < slides.length; i++) {
                slides[i].style.display = "none";
            }
            for (i = 0; i < dots.length; i++) {
                dots[i].className = dots[i].className.replace(" active", "");
            }
            slides[slideIndex - 1].style.display = "block";
            dots[slideIndex - 1].className += " active";
            captionText.innerHTML = dots[slideIndex - 1].alt;
        }
    </script>
    <script src="~/Scripts/AngularData/App.js"></script>
    <script>
        var ProductId=@Model.Product.Id;
        app.controller("CustomerReviewController", function ($scope, AddToCart, CartToCookieService) {

            $scope.reviews=[];
            $scope.review={
                "ProductId": ProductId,
                "Name": null,
                "Email": null,
                "Review": null
            };
            $scope.AddReview=function()
            {
                $.ajax({
                    type: 'POST',
                    url: "/api/CustomerReviews/PostCustomerReview",
                    data: $scope.review,
                    dataType: "Json",
                    success: function(resultData) { alert("Save Complete"); }
                });
            };
            $scope.GetReviews=function()
            {
                $.ajax({
                    type: 'Get',
                    url: "/api/CustomerReviews/GetCustomerReviews?ProductId="+ProductId,
                    dataType: "json",
                    success: function(resultData) {

                        $scope.reviews=resultData; 
                        $scope.$apply(); }
                });
            };
            $scope.GetReviews();
        });
    </script>

    <script>
        $(document).ready(function(){

            var native_width = 0;
            var native_height = 0;
            $(".large").css("background","url('" + $(".small").attr("src") + "') no-repeat");

            //Now the mousemove function
            $(".magnify").mousemove(function(e){
                //When the user hovers on the image, the script will first calculate
                //the native dimensions if they don't exist. Only after the native dimensions
                //are available, the script will show the zoomed version.
                if(!native_width && !native_height)
                {
                    //This will create a new image object with the same image as that in .small
                    //We cannot directly get the dimensions from .small because of the 
                    //width specified to 200px in the html. To get the actual dimensions we have
                    //created this image object.
                    var image_object = new Image();
                    image_object.src = $(".small").attr("src");
			
                    //This code is wrapped in the .load function which is important.
                    //width and height of the object would return 0 if accessed before 
                    //the image gets loaded.
                    native_width = image_object.width;
                    native_height = image_object.height;
                }
                else
                {
                    //x/y coordinates of the mouse
                    //This is the position of .magnify with respect to the document.
                    var magnify_offset = $(this).offset();
                    //We will deduct the positions of .magnify from the mouse positions with
                    //respect to the document to get the mouse positions with respect to the 
                    //container(.magnify)
                    var mx = e.pageX - magnify_offset.left;
                    var my = e.pageY - magnify_offset.top;
			
                    //Finally the code to fade out the glass if the mouse is outside the container
                    if(mx < $(this).width() && my < $(this).height() && mx > 0 && my > 0)
                    {
                        $(".large").fadeIn(100);
                    }
                    else
                    {
                        $(".large").fadeOut(100);
                    }
                    if($(".large").is(":visible"))
                    {
                        //The background position of .large will be changed according to the position
                        //of the mouse over the .small image. So we will get the ratio of the pixel
                        //under the mouse pointer with respect to the image and use that to position the 
                        //large image inside the magnifying glass
                        var rx = Math.round(mx/$(".small").width()*native_width - $(".large").width()/2)*-1;
                        var ry = Math.round(my/$(".small").height()*native_height - $(".large").height()/2)*-1;
                        var bgp = rx + "px " + ry + "px";
				
                        //Time to move the magnifying glass with the mouse
                        var px = mx - $(".large").width()/2;
                        var py = my - $(".large").height()/2;
                        //Now the glass moves with the mouse
                        //The logic is to deduct half of the glass's width and height from the 
                        //mouse coordinates to place it with its center at the mouse coordinates
				
                        //If you hover on the image now, you should see the magnifying glass in action
                        $(".large").css({left: px, top: py, backgroundPosition: bgp});
                    }
                }
            })
        })
    </script>


    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script>
        var options = {
            "key": "rzp_test_JHgzrt4lQIR3KO",
            "amount": "2000", // 2000 paise = INR 20
            "name": "ShivSaagaronline.com",
            "description":'@Model.Product.ProductName',
            "image": "http://shivamitcs.in/css/images/logo.png",
            "handler": function (response){
                alert(response.razorpay_payment_id);
            },
            "prefill": {
                "name": "Ajay Paliwal",
                "email": "ajaypaliwal.cto@outlook.com"
            },
            "notes": {
                "address": "Nathdwara"
            },
            "theme": {
                "color": "#F37254"
            }
        };
        var rzp1 = new Razorpay(options);

        document.getElementById('rzp-button1').onclick = function(e){
            rzp1.open();
            e.preventDefault();
        }
    </script>
}